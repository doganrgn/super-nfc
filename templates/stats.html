{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="mb-0">ğŸ“ˆ Ziyaret Ä°statistikleri â€” {{ shortid }}</h2>
  <div>
    <a class="btn btn-sm btn-outline-secondary" href="/stats/{{ shortid }}?days=7">7 gÃ¼n</a>
    <a class="btn btn-sm btn-outline-secondary" href="/stats/{{ shortid }}?days=30">30 gÃ¼n</a>
  </div>
</div>

<div class="card">
  <div class="card-body">
    <canvas id="chart" height="120"></canvas>
  </div>
</div>

<div class="mt-3">
  <a href="/t/{{ shortid }}" class="btn btn-sm btn-primary" target="_blank" rel="noopener">Tag SayfasÄ±</a>
  <a href="/edit/{{ shortid }}" class="btn btn-sm btn-outline-primary">DÃ¼zenle</a>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
(async () => {
  const days = {{ days }};
  const shortid = "{{ shortid }}";
  const res = await fetch(`/api/stats/${shortid}?days=${days}`);
  const data = await res.json();

  const ctx = document.getElementById('chart').getContext('2d');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: data.labels,
      datasets: [{
        label: `GÃ¼nlÃ¼k gÃ¶rÃ¼ntÃ¼lenme (${days})`,
        data: data.values,
        borderWidth: 2,
        fill: false,
        tension: 0.2
      }]
    },
    options: {
      responsive: true,
      scales: { y: { beginAtZero: true, ticks: { precision:0 } } }
    }
  });
})();
</script>
{% endblock %}
